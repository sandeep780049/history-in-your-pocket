{% extends "layout.html" %}
{% block title %}Notes â€” History in Your Pocket{% endblock %}
{% block content %}
<div class="card">
  <div class="title">Notes</div>
  <div class="small">Write quick revision notes. Notes are stored in your browser only.</div>
  <div style="margin-top:12px">
    <textarea id="notesArea" rows="8" style="width:100%;padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);color:#fff;border:0"></textarea>
    <div style="margin-top:8px">
      <button class="primary" id="saveNotes">Save Notes</button>
      <button class="ghost" id="clearNotes">Clear</button>
      <button class="ghost" id="exportNotes">Export</button>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script>
const NOTES_KEY = "hip_notes_v1";
function loadNotes(){
  try { return localStorage.getItem(NOTES_KEY) || ""; } catch(e){ return ""; }
}
function saveNotes(txt){
  localStorage.setItem(NOTES_KEY, txt || "");
}
document.addEventListener("DOMContentLoaded", function(){
  const ta = document.getElementById("notesArea");
  ta.value = loadNotes();
  document.getElementById("saveNotes").addEventListener("click", function(){
    saveNotes(ta.value);
    alert("Notes saved locally.");
  });
  document.getElementById("clearNotes").addEventListener("click", function(){
    if(confirm("Clear notes?")) { ta.value=""; saveNotes(""); }
  });
  document.getElementById("exportNotes").addEventListener("click", function(){
    const text = ta.value || "";
    const ts = new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");
    const filename = `notes-${ts}.txt`;
    downloadFile(filename, text, "text/plain");
  });
});
</script>
{% endblock %}
